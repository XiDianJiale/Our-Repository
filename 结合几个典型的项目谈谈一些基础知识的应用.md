**如果说正常人类的学习方法和正常盖楼一样一点一点打好基础，然后开始操作和实现复杂和综合的一个任务。**

**那么天才懂得同时从项目入手up to down的方法 /doge**
![微信图片_20241102224455](https://github.com/user-attachments/assets/4f9a6794-0e8c-4ce4-b28a-5b0550d4a0ee)


**结合几个典型的项目来把握一下做出成果和基础概念的联系  always get the whole picture first when u start a project!!**



学习STM32微控制器的最佳方式之一是通过具体的项目来应用和理解各种概念。以下将结合几个常见的学习项目，深入探讨GPIO、中断、定时器、通信接口、DMA等概念的具体使用。

### 项目一：LED闪烁

**概念应用：GPIO与定时器**

#### 项目描述：
LED闪烁是大多数嵌入式初学者的第一个项目。在这个项目中，我们通过编程控制一颗LED灯以一定频率闪烁。

#### 实现步骤：

1. **使用GPIO**
   - 配置STM32的GPIO端口为输出模式。
   - 连接LED到指定的GPIO引脚。

2. **使用定时器**
   - 配置定时器生成一个一定的时间间隔，比如500ms。
   - 在定时器中断服务例程中改变LED的状态，开（点亮）和关（熄灭）。

#### 具体代码示例：
```c
void TIM2_IRQHandler(void) {
    if (TIM2->SR & TIM_SR_UIF) { // 检查更新中断标志
        TIM2->SR &= ~TIM_SR_UIF; // 清除标志
        GPIOA->ODR ^= (1 << 5);  // 切换PA5（LED）
    }
}

void init_timer() {
    // 初始化定时器2
    RCC->APB1ENR |= RCC_APB1ENR_TIM2EN; // 使能定时器时钟
    TIM2->PSC = 16000 - 1; // 预分频器，1ms计时
    TIM2->ARR = 500 - 1;  // 自动重载值，500ms
    TIM2->DIER |= TIM_DIER_UIE; // 使能更新中断
    NVIC_EnableIRQ(TIM2_IRQn); // 使能定时器中断
    TIM2->CR1 |= TIM_CR1_CEN; // 启动定时器
}
```

### 项目二：按钮控制LED

**概念应用：GPIO与中断**

#### 项目描述：
在这个项目中，我们将通过按下一个按钮来控制LED的开关。

#### 实现步骤：

1. **使用GPIO**
   - 配置一个GPIO引脚为输入模式，与按钮相连。
   - 配置另一个GPIO引脚为输出，与LED相连。

2. **使用中断**
   - 将按钮的GPIO配置为外部中断模式（例如，下降沿触发）。
   - 在中断服务例程中，切换LED的状态。

#### 具体代码示例：
```c
void EXTI0_IRQHandler(void) {
    if (EXTI->PR & EXTI_PR_PR0) { // 检查中断请求
        EXTI->PR |= EXTI_PR_PR0; // 清除中断请求
        GPIOA->ODR ^= (1 << 5);  // 切换PA5（LED）
    }
}

void init_gpio() {
    // 初始化按钮GPIO为输入
    RCC->AHB1ENR |= RCC_AHB1ENR_GPIOAEN;
    GPIOA->MODER &= ~(3 << (0 * 2)); // PA0为输入
    // 配置EXTI
    SYSCFG->EXTICR[0] |= SYSCFG_EXTICR1_EXTI0_PA; // PA0连接到外部中断0
    EXTI->IMR |= EXTI_IMR_IM0; // 使能中断
    EXTI->FTSR |= EXTI_FTSR_TR0; // 下降沿触发
    NVIC_EnableIRQ(EXTI0_IRQn); // 使能中断
}
```

### 项目三：温度监测与显示

**概念应用：ADC、I2C、定时器**

#### 项目描述：
本项目使用温度传感器（如DS18B20）读取温度值，并通过I2C接口发送给LCD显示模块（如I2C LCD）。

#### 实现步骤：

1. **使用ADC**
   - 如果使用模拟温度传感器，如LM35，配置ADC读取温度值，将其转换为数字值。
   
2. **使用I2C**
   - 配置I2C通信，与I2C LCD连接，实现数据的写入和显示。

3. **使用定时器**
   - 使用定时器定时读取温度传感器，并将数据发送给LCD显示。

#### 具体代码示例：
```c
void TIM3_IRQHandler(void) {
    if (TIM3->SR & TIM_SR_UIF) { // 检查更新中断标志
        TIM3->SR &= ~TIM_SR_UIF; // 清除标志
        // 读取ADC值
        ADC1->CR2 |= ADC_CR2_SWSTART; // 启动转换
        while(!(ADC1->SR & ADC_SR_EOC)); // 等待转换完成
        uint32_t temp = ADC1->DR; // 获取温度值
        // 通过I2C发送到LCD
        I2C_send_data(temp);
    }
}

void init_adc() {
    // 初始化ADC
    RCC->APB2ENR |= RCC_APB2ENR_ADC1EN; // 使能ADC时钟
    ADC1->CR1 = 0; // 配置ADC
    ADC1->CR2 |= ADC_CR2_ADON; // 打开ADC
}
```

### 项目四：使用PWM控制马达速度

**概念应用：PWM与定时器**

#### 项目描述：
本项目控制伺服电机或直流电动机的速度。通过调节PWM信号的占空比来控制电机的转速。

#### 实现步骤：

1. **使用定时器生成PWM信号**
   - 配置定时器用于PWM生成。
   - 设置PWM的占空比，以控制电机的转速。

2. **使用GPIO**
   - 将定时器输出连接到电机驱动器输入端。

#### 具体代码示例：
```c
void init_pwm() {
    // 初始化定时器4用于PWM
    RCC->APB1ENR |= RCC_APB1ENR_TIM4EN; // 使能TIM4
    TIM4->PSC = 16000 - 1; // 1ms计数
    TIM4->ARR = 100 - 1; // PWM周期
    TIM4->CCR1 = 50; // 50%占空比
    TIM4->CCMR1 |= (6 << TIM_CCMR1_OC1M_Pos); // PWM模式1
    TIM4->CCER |= TIM_CCER_CC1E; // 使能输出
    TIM4->CR1 |= TIM_CR1_CEN; // 启动定时器
}
```

### 项目五：基于蓝牙的无线控制

**概念应用：UART与中断**

#### 项目描述：
利用HC-05蓝牙模块，通过UART接收来自手机的信息，并控制设备（如LED）响应。

#### 实现步骤：

1. **使用UART**
   - 配置UART用于与蓝牙模块通信。

2. **使用中断**
   - 当接收到蓝牙发送的数据时，触发中断并控制LED状态。

#### 具体代码示例：
```c
void USART2_IRQHandler(void) {
    if (USART2->SR & USART_SR_RXNE) { // 检查接收中断
        char received = USART2->DR; // 读取接收到的数据
        if (received == '1') {
            GPIOA->ODR |= (1 << 5); // 点亮LED
        } else if (received == '0') {
            GPIOA->ODR &= ~(1 << 5); // 熄灭LED
        }
    }
}

void init_uart() {
    // 初始化UART2
    RCC->APB1ENR |= RCC_APB1ENR_USART2EN; // 使能USART2
    USART2->BRR = 16000000 / 9600; // 波特率9600
    USART2->CR1 |= USART_CR1_RE | USART_CR1_TE | USART_CR1_UE; // 使能接收、发送
    NVIC_EnableIRQ(USART2_IRQn); // 使能中断
}
```

### 项目六：数据采集与传输

**概念应用：DMA与ADC**

#### 项目描述：
通过DMA进行高效的数据采集，实时读取传感器数据并存储到内存中，然后通过UART发送给PC。

#### 实现步骤：

1. **配置ADC与DMA**
   - 使用DMA将ADC转换结果存入数组。

2. **使用UART发送数据**
   - 使用UART将采集到的数据发送到PC。

#### 具体代码示例：
```c
void init_dma() {
    RCC->AHB1ENR |= RCC_AHB1ENR_DMA1EN; // 使能DMA1时钟
    DMA1_Stream0->CR |= DMA_SxCR_CHSEL_0; // 选择通道
    DMA1_Stream0->PAR = (uint32_t)&ADC1->DR; // 设置外设地址
    DMA1_Stream0->M0AR = (uint32_t)adc_buffer; // 设置内存地址
    DMA1_Stream0->NDTR = BUFFER_SIZE; // 设置传输数据量
    DMA1_Stream0->CR |= DMA_SxCR_EN; // 启动DMA
}
```

### 综合总结

通过这些项目，可以具体理解STM32的各种概念及其在实际应用中的使用方式。每个项目中不同的功能块如GPIO、中断、定时器、ADC、I2C、PWM、UART、DMA等都扮演着重要的角色，彼此协作使得系统能够可靠地执行任务。

从简单的LED闪烁到复杂的数据采集与传输，各种技术的运用使得我们能够在嵌入式系统设计中实现更丰富的功能。无论是初学者还是有经验的开发者，通过实际项目的实践和不断的探索，都会在STM32的学习中迈出更坚实的步伐。随着经验的积累和技术的深入掌握，未来还有更多更复杂的项目等待你去实现，开启更广阔的创作空间。

